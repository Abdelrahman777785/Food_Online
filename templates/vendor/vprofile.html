{% extends 'base.html' %}
{% load static %}
{% block content %}
{% include 'includes/alerts.html' %}
<!-- Main Section Start -->
<div class="main-section">
    <!--Load the cover here -->
    {% include 'includes/cover.html' %}
    <div class="page-section account-header buyer-logged-in">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                  <!-- Load the sidebar here -->
                  {% include 'includes/v_sidebar.html' %}
                <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                    <div class="user-dashboard loader-holder">
                        <div class="user-holder">
                            <h5 class="text-uppercase">Manage Your Restaurant</h5>
                            <!-- My restaurant Form Start -->
                            <form action="{% url 'vprofile' %}" method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="form-fields-set">
                                    <ul>
                                        <li>
                                            <div class="row">
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="restaurant-info">
                                                        <div class="img-holder">
                                                            <ul class="foodbakery-gallery-holder">
                                                                <li class="gal-img">
                                                                    <div class="drag-list">
                                                                        <div class="item-thumb">
                                                                            {% if profile.profile_picture %}
                                                                            <img class="thumbnail" src="{{profile.profile_picture.url}}" alt="">
                                                                            {% else %}
                                                                            <img class="thumbnail" src="{% static 'images/default-profile.jpg' %}" alt="">
                                                                            {% endif %}
                                                                        </div>
                                                                        <div class="item-assts">
                                                                            <ul class="list-inline pull-right">
                                                                                <li class="close-btn"><a href="javascript:void(0)"><i class="icon-cross-out"></i></a></li>
                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <div class="text-holder">
                                                            <label>Update Profile Picture</label>
                                                            <div class="upload-gallery">
                                                                {{ profile_form.profile_picture }}
                                                            </div>
                                                            <span>Update your avatar manually, If the not set the default Gravatar will be the same as your login email/user account. Max Upload Size: 1MB,</span>
                                                        </div>
                                                        <label class="text-danger" style="color: rgb(230, 36, 36);">{{ profile_form.profile_picture.errors }}</label>
                                                    </div>
                                                </div>
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="restaurant-info">
                                                        <div class="img-holder">
                                                            <ul class="foodbakery-gallery-holder">
                                                                <li class="gal-img">
                                                                    <div class="drag-list">
                                                                        <div class="item-thumb">
                                                                            {% if profile.cover_photo %}
                                                                            <img class="thumbnail" src="{{ profile.cover_photo.url }}" alt="Cover Photo">
                                                                            {% else %}
                                                                            <img class="thumbnail" src="{% static 'images/default-cover.png' %}" alt="Cover Photo">
                                                                            {% endif %}
                                                                        </div>
                                                                        <div class="item-assts">
                                                                            <ul class="list-inline pull-right">
                                                                                <li class="close-btn"><a href="javascript:void(0)"><i class="icon-cross-out"></i></a></li>
                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <div class="text-holder">
                                                            <label>Update Cover Photo</label>
                                                            <div class="upload-gallery">
                                                                {{profile_form.cover_photo}}
                                                            </div>
                                                            <span>Update your cover image manually, If the not set the default cover image will be showing on your restaurant detail page. Max Upload Size: 1MB,</span>
                                                        </div>
                                                        <label class="text-danger" style="color: rgb(230, 36, 36);">{{ profile_form.cover_photo.errors }}</label>
                                                    </div>
                                                </div>
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="restaurant-info">
                                                        <div class="img-holder">
                                                            <ul class="foodbakery-gallery-holder">
                                                                <li class="gal-img">
                                                                    <div class="drag-list">
                                                                        <div class="item-thumb">
                                                                            <img class="thumbnail" src="{{vendor.vendor_license.url}}" alt="Vendor License">
                                                                        </div>
                                                                        <div class="item-assts">
                                                                            <ul class="list-inline pull-right">
                                                                                <li class="close-btn"><a href="javascript:void(0)"><i class="icon-cross-out"></i></a></li>
                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <div class="text-holder">
                                                            <label>Update License</label>
                                                            <div class="upload-gallery">
                                                                {{vendor_form.vendor_license}}
                                                               <!-- <input class="foodbakery-dev-gallery-uploader" style="display:none;" type="file">
                                                                <a href="#" class="upload-btn foodbakery-dev-cover-upload-btn">Update License</a>-->
                                                            </div>
                                                            <span>Update your License image manually, If the not set the default activated. Max Upload Size: 1MB,</span>
                                                        </div>
                                                        <label class="text-danger" style="color: rgb(230, 36, 36);">{{ vendor_form.vendor_license.errors }}</label>
                                                    </div>
                                                </div>
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>Restaurant name *</label>
                                                        {{vendor_form.vendor_name}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>Address *</label>
                                                        {{profile_form.address}}
                                                        <!-- <small class="text-muted float-right">powered by Google</small> -->
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                        
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>Country *</label>
                                                        {{profile_form.country}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>state *</label>
                                                        {{profile_form.state}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>City *</label>
                                                        {{profile_form.city}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>Pin code *</label>
                                                        {{profile_form.pin_code}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>Latitude *</label>
                                                        {{profile_form.latitude}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label>Longitude *</label>
                                                        {{profile_form.longitude}}
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                    </div>
                                                </div>
                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="field-holder">
                                                        <label style="">Select Your Location in Maps</label>
                                                        <div id="map"></div>
                                                        <!-- <small class="text-muted float-right">powered by Google</small> -->
                                                        <!--<input type="text" placeholder="i.e Pizza Hut" class="foodbakery-dev-req-field">-->
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            
                                        </li>
                                    </ul>
                                    <div>
                                        <div class="field-holder">
                                            <div class="payment-holder input-button-loader">
                                                <input type="submit" value="Update Restaurant">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>         
                            
                            <style>
                                #map{
                                    height: 100vh;
                                    width: 100%;
                                }
                        
                                .info {
                                    padding: 6px 8px;
                                    font: 14px/16px Arial, Helvetica, sans-serif;
                                    background: white;
                                    background: rgba(255,255,255,0.8);
                                    box-shadow: 0 0 15px rgba(0,0,0,0.2);
                                    border-radius: 5px;
                                }
                                .info h4 {
                                    margin: 0 0 5px;
                                    color: #777;
                                }
                                
                                .legend {
                                    line-height: 18px;
                                    color: #555;
                                }
                                .legend i {
                                    width: 18px;
                                    height: 18px;
                                    float: left;
                                    margin-right: 8px;
                                    opacity: 0.7;
                                }
                                
                                
                            </style>
                            <script>

                                // var map = L.map('map').setView([30.124386, 31.249844], 12);

                                // var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                //     maxZoom: 19,
                                //     attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                                // });
                                // osm.addTo(map);

                                 

                               
                                // // var marker = L.marker([51.5, -0.09]).addTo(map);
                                // // function onMapClick(e) {
                                // //     alert("You clicked the map at " + e.latlng);
                                // // }

                                // // map.on('click', onMapClick);

                   
                                // var watercolor = L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_watercolor/{z}/{x}/{y}.{ext}', {
                                //     minZoom: 1,
                                //     maxZoom: 16,
                                //     subdomains: 'abcd',
                                //     attribution: '&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://www.stamen.com/" target="_blank">Stamen Design</a> &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                                //     ext: 'jpg'
                                // });
                                
                                // googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
                                //     maxZoom: 20,
                                //     subdomains:['mt0','mt1','mt2','mt3']
                                // });
                                // // googleStreets.addTo(map);

                                // var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                                //     attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
                                // });
                                

                                // googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{
                                //     maxZoom: 20,
                                //     subdomains:['mt0','mt1','mt2','mt3']
                                // });
                                // // googleHybrid.addTo(map);

                                // // Marker
                                // // var singelMarker = L.marker([30.124386, 31.249844], { draggable: true}).addTo(map);
                                // // var popup = singelMarker.bindPopup('This is a popup' + singelMarker.getlatlng()).openPopup();
                                // // popup.addTo(map);

                                // console.log(singelMarker.toGeoJSON())

                                // //latlng
                                // map.on('mousemove', function (e){
                                //     document.getElementsByClassName('coordinate')[0].innerHTML =  'Latitude: ' + e.latlng.lat + ' Longitude: ' + e.latlng.lng; 

                                // });


                                // var MARKERS_MAX = 1;

                                // var map = L.map('map').setView([51.4661, 7.2491], 14);
                                // L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                //     attribution: 
                                //     '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                                // }).addTo(map);

                                // a layer group, used here like a container for markers
                                // var markersGroup = L.layerGroup();
                                // map.addLayer(markersGroup);

       
                                
                                // map.on('click', function(e) {
                                //     // get the count of currently displayed markers
                                //     var markersCount = markersGroup.getLayers().length;

                                //     if (markersCount >= MARKERS_MAX) {
                                //         // remove the oldest marker (first one added)
                                //         var firstMarker = markersGroup.getLayers()[0];
                                //         markersGroup.removeLayer(firstMarker);
                                //     }

                                //     // add the new marker
                                //     var marker = L.marker(e.latlng).addTo(markersGroup);

                                //     // Get latitude and longitude of the marker
                                //     var lat = e.latlng.lat;
                                //     var lng = e.latlng.lng;


                                //     $('#id_latitude').val(lat);
                                //     $('#id_longitude').val(lng);
                                    
                                // });
                                var MARKERS_MAX = 1;
                                /*===================================================
                                                    OSM  LAYER               
                                ===================================================*/

                                var map = L.map('map').setView([30.124386, 31.249844], 6);
                                var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                                });
                                osm.addTo(map);

                                /*===================================================
                                                    MARKER               
                                ===================================================*/

                                var markersGroup = L.layerGroup();
                                map.addLayer(markersGroup);

       
                                
                                map.on('click', function(e) {
                                    // get the count of currently displayed markers
                                    var markersCount = markersGroup.getLayers().length;

                                    if (markersCount >= MARKERS_MAX) {
                                        // remove the oldest marker (first one added)
                                        var firstMarker = markersGroup.getLayers()[0];
                                        markersGroup.removeLayer(firstMarker);
                                    }

                                    // add the new marker
                                    var marker = L.marker(e.latlng).addTo(markersGroup);

                                    // Get latitude and longitude of the marker
                                    var lat = e.latlng.lat;
                                    var lng = e.latlng.lng;


                                    $('#id_latitude').val(lat);
                                    $('#id_longitude').val(lng);
                                    
                                });

                                /*===================================================
                                                    TILE LAYER               
                                ===================================================*/

                                var CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                                subdomains: 'abcd',
                                    maxZoom: 19
                                });
                                CartoDB_DarkMatter.addTo(map);

                                // Google Map Layer

                                googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
                                    maxZoom: 20,
                                    subdomains:['mt0','mt1','mt2','mt3']
                                });
                                googleStreets.addTo(map);

                                // Satelite Layer
                                googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
                                maxZoom: 22,
                                subdomains:['mt0','mt1','mt2','mt3']
                                });
                                googleSat.addTo(map);

                                var Stamen_Watercolor = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}', {
                                attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                                subdomains: 'abcd',
                                minZoom: 1,
                                maxZoom: 16,
                                ext: 'jpg'
                                });
                                Stamen_Watercolor.addTo(map);


                                /*===================================================
                                                    GEOJSON               
                                ===================================================*/

                                var linedata = L.geoJSON(lineJSON)
                                var pointdata = L.geoJSON(pointJSON)
                                var nepalData = L.geoJSON(nepaldataa)
                                var polygondata = L.geoJSON(polygonJSON,{
                                    onEachFeature: function(feature,layer){
                                        layer.bindPopup('<b>This is a </b>' + feature.properties.name)
                                    },
                                    style:{
                                        fillColor: 'red',
                                        fillOpacity:1,
                                        color: 'green'
                                    }
                                })

                                /*===================================================
                                                    LAYER CONTROL               
                                ===================================================*/

                                var baseLayers = {
                                    "Satellite":googleSat,
                                    "Google Map":googleStreets,
                                    "Water Color":Stamen_Watercolor,
                                    "OpenStreetMap": osm,
                                };

                                var overlays = {
                                    
                                };

                                L.control.layers(baseLayers, overlays).addTo(map);


                                /*===================================================
                                                    SEARCH BUTTON               
                                ===================================================*/

                                L.Control.geocoder().addTo(map);

                            
                            </script>
                        </div> 
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Main Section End -->

{% endblock %}